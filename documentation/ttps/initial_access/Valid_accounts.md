# Valid Accounts

## Description

An attacker can impersonate the login credentials of a legitimate account to gain unauthorized access to the company's Google Workspace domain.

## Example of Attack

After obtaining the credentials of a legitimate Google Workspace account belonging to the company, for example, through Infostealer logs, the attacker can log in to the account to perform malicious actions.

## MITRE documentation

- Tactic : Initial Access
- Technique : Valid Accounts
- Sub-technique : Cloud Accounts
- ID : [T1078.004](https://attack.mitre.org/techniques/T1078/004/)

## Detection

It is possible to detect suspicious login events generated by Google Workspace in the logs (see below).

Moreover, certain context-aware access rules may trigger an alert because the connection conditions do not match the established rule. For example: the geographic location of the connection should only be in Europe, but the connection is coming from Mexico.

> Please note that the verbosity of context-aware access events is significant and may correspond to legitimate "errors" (attempted login to the account before connecting to the company's VPN).


### Related Google Workspace Events

- suspicious_login
- suspicious_login_less_secure_app
- suspicious_programmatic_login
- user_signed_out_due_to_suspicious_session_cookie
- account_disabled_generic
- account_disabled_hijacked
- gov_attack_warning
- login_failure
- risky_sensitive_action_allowed
- risky_sensitive_action_blocked

## Remediation

The analyst can clear login cookies to log out the user and thus the attacker from all devices and browsers.

The victim's account can also be temporarily suspended and the password reset while awaiting contact with them for reactivation.

> Please note that an administrator cannot suspend an account with an equivalent or higher level of rights.
If an administrator account needs to be suspended due to compromise, only the super-administrator account will be able to perform the operation.


## Recommendations

Google Workspace offers various features to strengthen the login process.

### Enabling the Advanced Protection Program

It is possible to activate the program on accounts to enhance security and access to data: enforcing the use of 2FA, limiting the rights granted to third-party applications (via OAuth tokens)... More information is available on the official program page : https://landing.google.com/advancedprotection/

![img](../resources/advanced_program.png)

### 2FA activation

It is possible to offer (or enforce) and configure accepted 2FA methods on accounts.

### Implementation of Context-Aware Access Rules

It is possible to implement access rules to restrict access to Google services. For example, limiting access to a specific IP address or a specific version of Google Chrome.

> Compatible editions for this feature: Frontline Standard; Enterprise Standard and Enterprise Plus; Education Standard and Education Plus; Enterprise Essentials Plus; Cloud Identity Premium.

> The administration portal is typically not sensitive to context-aware access rules.
