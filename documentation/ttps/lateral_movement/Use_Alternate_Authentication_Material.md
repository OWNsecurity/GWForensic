# Use Alternate Authentication Material

## Description

It is possible to add an SSH key in GCP to connect to virtual machines.

## Example of Attack

If GCP is being used and there is access to a GCP project containing virtual machines (VMs), the attacker can add their own SSH key to the project's metadata, allowing them to be authorized to connect (https://cloud.google.com/compute/docs/connect/add-ssh-keys?hl=fr).

## MITRE documentation

- Tactic : Lateral Movement
- Technique : Remote Services
- Sub-technique : SSH
- ID : [T1021.004](https://attack.mitre.org/techniques/T1021/004/)

## Detection

It is possible to detect suspicious connection events generated by Google Workspace in the logs (see below).

### Related Google Workspace Events

- IMPORT_SSH_PUBLIC_KEY
- UPDATE_SSH_PUBLIC_KEY

## Remediation

The analyst can clear login cookies to log out the user and thus the attacker from all devices and browsers.

On the GCP platform side, it is important to check if any changes have been made to the connection metadata for the various VMs. The attacker may have potentially added or modified an SSH key to allow the connection.


## Recommendations

/
